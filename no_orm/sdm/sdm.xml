<?xml version="1.0" encoding="UTF-8"?>
<sdm xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:noNamespaceSchemaLocation="sdm.xsd">

    <dto-class name="Project" ref="projects"/>

    <dto-class name="ProjectLi" ref="projects">
        <field type="int64$" column="p_tasks_count"/>
    </dto-class>

    <dto-class name="Task" ref="tasks"/>

    <dto-class name="TaskLi" ref="tasks">

        <header>// TaskLi list item (no p_id, no t_comments)</header>

        <field type="-" column="p_id"/>
        <field type="-" column="t_comments"/>

    </dto-class>

    <dao-class name="ProjectsDao">

        <crud dto="Project">
            <create/>
            <read/>
            <update/>
            <delete/>
        </crud>

        <query-dto-list method="ReadAll" dto="ProjectLi" ref="get_projects.sql"/>

        <!-- testing -->
        <query-list method="GetProjectIds" return-type="int64" ref="get_projects.sql"/>

        <!-- testing -->
        <query method="GetProjectId" return-type="int64" ref="get_projects.sql"/>

    </dao-class>

    <dao-class name="TasksDao">

        <crud table="tasks" dto="Task"/>

        <query-dto-list method="ReadByProject(int64 pId)" ref="get_project_tasks.sql" dto="TaskLi"/>

        <exec-dml method="DelByProject(pId)" ref="delete_project_tasks.sql"/>

        <!-- testing -->

        <query method="GetCount()" ref="select count(*) from tasks" return-type="int64"/>

        <!-- testing -->

        <query-dto-list dto="TaskLi" method="GetProjectTasks2(g_id)" ref="delete_project_tasks.sql"/>

        <!-- testing -->

        <query-dto dto="Task" method="GetTask(g_id)" ref="delete_project_tasks.sql"/>

    </dao-class>

</sdm>
